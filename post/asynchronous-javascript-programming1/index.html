<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Asynchronous JavaScript Programming [1] - ORDER CHAOS</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="CaeChao" /><meta name="description" content="Introduction What is asynchronous programming?
Well, imagine you are sitting in front of your computer screen, putting your hands on your beloved keyboard and doing your coding and thinking, and suddenly you realize that there is a piece of necessary information you need to ask your friend to finish your work, so you grab your phone nearby and send an asking message to your friend, and this might take him some time to respond." />





<meta name="generator" content="Hugo 0.111.3 with theme even" />


<link rel="canonical" href="https://caechao.github.io/post/asynchronous-javascript-programming1/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">






<link href="/sass/main.min.578bb701529bf4d4789c404ed5ab321b2498ceb990c9d697d9cd9ddbc131c3a8.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Asynchronous JavaScript Programming [1]" />
<meta property="og:description" content="Introduction What is asynchronous programming?
Well, imagine you are sitting in front of your computer screen, putting your hands on your beloved keyboard and doing your coding and thinking, and suddenly you realize that there is a piece of necessary information you need to ask your friend to finish your work, so you grab your phone nearby and send an asking message to your friend, and this might take him some time to respond." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://caechao.github.io/post/asynchronous-javascript-programming1/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-05-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-05-17T00:00:00+00:00" />
<meta itemprop="name" content="Asynchronous JavaScript Programming [1]">
<meta itemprop="description" content="Introduction What is asynchronous programming?
Well, imagine you are sitting in front of your computer screen, putting your hands on your beloved keyboard and doing your coding and thinking, and suddenly you realize that there is a piece of necessary information you need to ask your friend to finish your work, so you grab your phone nearby and send an asking message to your friend, and this might take him some time to respond."><meta itemprop="datePublished" content="2019-05-17T00:00:00+00:00" />
<meta itemprop="dateModified" content="2019-05-17T00:00:00+00:00" />
<meta itemprop="wordCount" content="839">
<meta itemprop="keywords" content="Programming,Programming.JavaScript," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Asynchronous JavaScript Programming [1]"/>
<meta name="twitter:description" content="Introduction What is asynchronous programming?
Well, imagine you are sitting in front of your computer screen, putting your hands on your beloved keyboard and doing your coding and thinking, and suddenly you realize that there is a piece of necessary information you need to ask your friend to finish your work, so you grab your phone nearby and send an asking message to your friend, and this might take him some time to respond."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <p class="logo" itemprop="headline">
          ORDER
        
        <span>
        
          CHAOS
        
        </span></p>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">HOME</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">ARCHIVES</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">TAGS</li>
      </a><a href="/projects/">
        <li class="mobile-menu-item">PROJECTS</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">ABOUT</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div id="header-outer" class="header-outer">
 <div id="header-inner" class="header-inner">
    <div class="logo-wrapper">
      <p class="logo" itemprop="headline">
            ORDER
          
          <span>
          
            CHAOS
          
          </span></p>
    </div>
    
    


    <nav class="social-links">
          <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
          <a href="https://caechao.github.io" class="iconfont icon-twitter" title="twitter"></a>
          <a href="https://github.com/CaeChao" class="iconfont icon-github" title="github"></a>
      <a href="https://caechao.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
        <a id="menu-search-btn" class="iconfont icon-search" title="search"></a>
    </nav>
 </div>
   <div id="search-form-wrap">
     <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
       <input type="search" name="q" class="search-form-input" placeholder="Search">
       <button type="submit" class="iconfont search-form-submit">&#xe60e;</button>
       <input type="hidden" name="sitesearch" value="https://caechao.github.io/">
     </form>
   </div>
   <div id="quotes" class="quotes">
     <i class="fa fa-quote-left"></i><span id="quote"></span>
     <span id="author"></span>
   </div>

   <nav class="site-navbar">
     <ul id="menu" class="menu">
       <li class="menu-item">
           <a class="menu-item-link" href="/">HOME</a>
         </li><li class="menu-item">
           <a class="menu-item-link" href="/post/">ARCHIVES</a>
         </li><li class="menu-item">
           <a class="menu-item-link" href="/tags/">TAGS</a>
         </li><li class="menu-item">
           <a class="menu-item-link" href="/projects/">PROJECTS</a>
         </li><li class="menu-item">
           <a class="menu-item-link" href="/about/">ABOUT</a>
         </li>
     </ul>
   </nav>
</iv>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Asynchronous JavaScript Programming [1]</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-05-17 </span>
        
      <span class="post-tags">
          <a href="/tags/programming/">Programming</a>
          <a href="/tags/programming.javascript/">Programming.JavaScript</a>
          </sapn>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#how-does-it-work-in-javascript">How does it work in JavaScript?</a>
          <ul>
            <li><a href="#stack-and-execution-context">Stack and Execution context</a></li>
            <li><a href="#another-worker">Another Worker</a></li>
          </ul>
        </li>
        <li><a href="#message-queue">Message Queue</a></li>
        <li><a href="#event-loop">Event Loop</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <!-- toc -->
<h2 id="introduction">Introduction</h2>
<p>What is asynchronous programming?<br>
Well, imagine you are sitting in front of your computer screen, putting your hands on your beloved keyboard and doing your coding and thinking, and suddenly you realize that there is a piece of necessary information you need to ask your friend to finish your work, so you grab your phone nearby and send an asking message to your friend, and this might take him some time to respond.</p>
<p>Now there are different ways for you to proceed:</p>
<ul>
<li>You stay on your phone and wait for his respond (<strong>Synchronous</strong>)</li>
<li>You tell your friend to send back that important information once he has that information. Meanwhile you can continue what tasks are you focusing on. (<strong>Asynchronous</strong>)</li>
</ul>
<p>The same principle applies to Computer:<br>
The central part of the computer is the processor, which just like your brain, but it works all the time.<br>
The programs are nothing but tasks that will keep the processor busy. But many programs not just interact with processors, they may also communicate with other computers over a network. (like sending messages to your friends)<br>
So when a single program need to make progress while it is waiting for some data back from a network request, asynchronous behavior happens.</p>
<h2 id="how-does-it-work-in-javascript">How does it work in JavaScript?</h2>
<p>There are some basic components in JavaScript runtime to construct the JavaScript concurrency model.</p>
<h3 id="stack-and-execution-context">Stack and Execution context</h3>
<p>Because JavaScript is a Single-threaded language, JavaScript has a single execution stack which execute synchronously</p>
<ul>
<li>Stacks are fundamental to function calls, each time a function is called it forms a new <em>stack frame</em></li>
<li>Each function call creates a new execution context, even a call to itself.</li>
<li>1 Global context as the base of stack<br>
&hellip;</li>
</ul>
<p>Because of these facts about stack, JavaScript will execute functions synchronously and a synchronous function blocks until it completes its operations, and behaves as LIFO (last in first out).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="line"><span class="cl"><span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="nx">taskA</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">taskB</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">taskC</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nx">The</span> <span class="nx">single</span> <span class="nx">thread</span> <span class="nx">process</span><span class="o">:</span>
</span></span><span class="line"><span class="cl"><span class="nx">Task</span> <span class="nx">A</span> <span class="o">--&gt;</span> <span class="nx">Task</span> <span class="nx">B</span> <span class="o">--&gt;</span> <span class="nx">Task</span> <span class="nx">C</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In JavaScript, the code inside taskA()(and taskB(), taskC()) is atomic, which means that once taskA() starts running, it cannot be interrupted and will finish before any code in taskB() can run.</p>
<h3 id="another-worker">Another Worker</h3>
<p>As I said before, JavaScript is generally a <strong>single-threaded synchronous</strong> language, so how can JavaScript performs <strong>asynchronous actions</strong>? Actually the asynchronous behavior is not part of the JavaScript language, rather they are built on host Environment like Browser or Nodejs, act like another worker or friend.<br>
If you replace asynchronous actions with synchronous actions, the webpage will be unresponsive while the script is running, the user will not be able to do anything, because the UI is locked by that time delay task.<br>
Here is how they work together:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taskA</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">taskB</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taskB</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taskC</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">taskA</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">taskC</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nx">JS</span> <span class="nx">Main</span> <span class="nx">Thread</span><span class="o">:</span> <span class="nx">Task</span> <span class="nx">A</span> <span class="o">--&gt;</span> <span class="nx">Task</span> <span class="nx">C</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nx">Worker</span> <span class="nx">Thread</span><span class="o">:</span> <span class="nx">Task</span> <span class="nx">B</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nx">output</span><span class="o">:</span> <span class="nx">a</span> <span class="nx">c</span> <span class="nx">b</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Have you noticed the taskB inside setTimeout function above? That is an asynchronous <strong>callback</strong> function which is a function that performs a slow action. Just like a friend sends you a message back.</p>
<h2 id="message-queue">Message Queue</h2>
<p>JavaScript runtime uses a message queue to receive incoming events, which is a list of messages to be processed. Queue behaves as FIFO(First in First out)</p>
<h2 id="event-loop">Event Loop</h2>
<p>The event loop runs in the same thread your JavaScript code runs in</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">queue</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nx">queue</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">event</span> <span class="o">=</span> <span class="nx">queue</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">event</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Event loop always waits for a message to arrive, and will pop message(event) from the message queue to stack after JS main thread finishes the tasks.<br>
Here is how event loop and message queue work together:<br>
<img src="/images/javascript/js-concurrency-model.png" alt="Js-concurrency-model"></p>
<p>Remember the setTimeout function above? Actually that function doesn&rsquo;t put that callback function taskB on the event loop queue. What it really does is set up a timer; when the timer expires, the host environment will place your callback into message queue. But if you have already had a lot of items inside your event loop at that moments, say like 20&hellip;then your new callback function must wait. That&rsquo;s why sometimes your setTimeout timers may not triggers your function punctually.</p>
<p>Because of this event loop model, it allows JavaScript runtime behaves concurrently and never blocking I/O operations</p>
<h2 id="summary">Summary</h2>
<p>So why asynchronous programming?<br>
Most of time JavaScript is synchronous, blocking, single-threaded, in which only one operation can be in progress at a time.<br>
But if we want to load some data from server side database like performing an Ajax querying and displaying the result, then it is better to push this off main JS thread and perform this task asynchronously.</p>
<p>So this is my introduction to asynchronous JavaScript Programming, I&rsquo;ll talk about some common problems involved in this model, and the evolution of asynchronous JavaSript from <strong>Callback</strong> to <strong>Promise</strong> to <strong>async await</strong> in the next article.</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">CaeChao</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2019-05-17
        
    </span>
  </p>
  
  
</div>

<footer class="post-footer">

      
      <nav class="post-nav">
        <a class="prev" href="/post/asynchronous-javascript-programming2/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Asynchronous JavaScript Programming [2]</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/object-oriented-programming/">
            <span class="next-text nav-default">Object Oriented Programming</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme -  based on
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2024<span class="heart"><i class="iconfont icon-heart"></i></span><span>CaeChao</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>




<script type="text/javascript" src="/js/main.min.37e575d2c1b8bfd433f19a73145bb756e2c92f1f379afc443e21143bdb671ac9.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-120206751-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>
</html>
